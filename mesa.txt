sudo apt build-dep ffmpeg mpv mplayer mesa vlc libplacebo pulseeffects pulseaudio libdrm

sudo apt-get install libx11-xcb-dev libxext-dev libxdamage-dev libxfixes-dev

sudo apt-get install python3-mako libxcb-randr0-dev libxrandr-dev libxcb-xinerama0-dev libxinerama-dev libxcursor-dev

sudo apt-get install libxcb-cursor-dev libxkbcommon-dev xutils-dev xutils-dev libpthread-stubs0-dev libpciaccess-dev

sudo apt-get install libffi-dev x11proto-xext-dev libxcb1-dev libxcb-*dev libssl-dev libgnutls28-dev x11proto-dri2-dev

sudo apt-get install x11proto-dri3-dev libx11-dev libxcb-glx0-dev libx11-xcb-dev libxext-dev libxdamage-dev libxfixes-dev

sudo apt-get install libva-dev x11proto-randr-dev x11proto-present-dev libclc-dev libelf-dev mesa-utils libvulkan-dev libvulkan1 libassimp-dev

sudo apt-get install libdrm-dev libxshmfence-dev libxxf86vm-dev libunwind-dev libwayland-dev wayland-protocols libwayland-egl-backend-dev valgrind libzstd-dev vulkan-tools

sudo apt-get install git build-essential bison flex meson cmake cmake-data libatomic-ops-dev

sudo pip3 install ninja



upstream rpi4

git clone https://github.com/mesa3d/mesa.git


checkout mesa-22.0.3


wget https://gitlab.freedesktop.org/mesa/mesa.git






32 bit 

git clone https://github.com/mesa3d/mesa.git && cd mesa && CFLAGS="-mcpu=cortex-a72 -mfpu=neon-fp-armv8" CXXFLAGS="-mcpu=cortex-a72 -mfpu=neon-fp-armv8" meson --prefix /usr -Dgles1=disabled -Dgles2=enabled -Dplatforms=x11 -Dvulkan-drivers=broadcom -Ddri-drivers= -Dgallium-drivers=v3d,kmsro,vc4,virgl,zink -Dbuildtype=release  build && ninja -C build -j4 && sudo ninja -C build install


64 bit 

git clone https://github.com/mesa3d/mesa.git && cd mesa && CFLAGS="-mcpu=cortex-a72" CXXFLAGS="-mcpu=cortex-a72" meson --prefix /usr -Dgles1=disabled -Dgles2=enabled -Dplatforms=x11 -Dvulkan-drivers=broadcom -Ddri-drivers= -Dgallium-drivers=v3d,kmsro,vc4,virgl,zink -Dbuildtype=release  build && ninja -C build -j4 && sudo ninja -C build install



